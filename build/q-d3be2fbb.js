var E=Object.defineProperty;var b=(o,e,t)=>e in o?E(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var f=(o,e,t)=>(b(o,typeof e!="symbol"?e+"":e,t),t);import{c as M,q as $,_ as B}from"./q-30db69eb.js";class C{constructor(e){this.name=e}toString(){return this.name}}class L extends C{}class H extends C{}class T{constructor(e,t,s){this.teacher=e,this.course=t,this.index=s}toString(){return`${this.teacher.name} ${this.course.name}${this.index}`}}class w{constructor(e,t){this.from=e,this.to=t}toString(){return`\u73ED\u7D1A'${this.from.course.name}': [${this.from.teacher.name} ${+this.from.index+1}] <-> [${this.to.teacher.name} ${+this.to.index+1}]`}removes(){return[this.from,this.to]}addFrom(){return new T(this.from.teacher,this.from.course,this.to.index)}addTo(){return new T(this.to.teacher,this.to.course,this.from.index)}}let m;(function(o){o[o.invalid=0]="invalid",o[o.tempValid=1]="tempValid",o[o.valid=2]="valid"})(m||(m={}));class x{constructor(){f(this,"changes",[]);f(this,"set2",[]);f(this,"days",5);f(this,"courses",7)}index(e,t){return+this.courses*e+t}indexOf(e){return this.set2.findIndex(t=>t.teacher.name===e.teacher.name&&t.course.name===e.course.name&&t.index==e.index)}delete(e){const t=this.indexOf(e);t>-1&&this.set2.splice(t,1)}setDays(e){this.days=Math.min(Math.max(+e,1),7)}setCourses(e){this.courses=Math.max(+e,1)}parse(e){return e.split(`
`).flatMap((s,l)=>l>this.days?[]:s.split(",").flatMap((a,i)=>{if(a==="")return[];if(i>this.courses)return[];const n=new H(a),r=+l*+this.courses+i;return[[n,r]]}))}setup(e,t){const s=new L(e);for(const[l,d]of this.parse(t)){const a=new T(s,l,d);this.set2.push(a)}}all(){return this.set2}findByTeacher(e,t){return t!=null?this.all().filter(s=>s.teacher.name===e.name&&s.index==t):this.all().filter(s=>s.teacher.name==e.name)}findByCourse(e,t){return t!=null?this.all().filter(s=>s.course.name===e.name&&s.index===t):this.all().filter(s=>s.course.name===e.name)}findByIndex(e){const t=+e%+this.courses+1,s=+e/+this.courses+1;return[t,s]}copy(){const e=new x;return e.set2=Array.from(this.set2),e.changes=Array.from(this.changes),e.days=this.days,e.courses=this.courses,e}append(e){const t=this.copy();if(t.changes.push(e),this.changes.length!=0&&this.changes[0].from.index==e.to.index)return[t,m.invalid];for(const s of e.removes())if(t.indexOf(s)!=-1)t.delete(s);else return[t,m.invalid];if(this.findByTeacher(e.addTo().teacher,e.addTo().index).length==0)t.set2.push(e.addTo());else return[t,m.invalid];switch(this.findByTeacher(e.addFrom().teacher,e.addFrom().index).length){case 0:return t.set2.push(e.addFrom()),[t,m.valid];case 1:return t.set2.push(e.addFrom()),[t,m.tempValid];default:return[t,m.invalid]}}change(e,t,s){const l=this.findByTeacher(e,t);if(l.length<=0)return[];const d=l[0].course,a=new T(e,d,t);return this._change(a,s)}_change(e,t){return t<=0?[]:this.findByCourse(e.course).filter(d=>d.teacher.name!==e.teacher.name).flatMap(d=>{const a=new w(e,d),[i,n]=this.append(a);switch(n){case m.invalid:return[];case m.valid:return[i];case m.tempValid:const r=e.teacher,u=a.to.index;return this.findByTeacher(r,u).filter(c=>c.course.name!==e.course.name).flatMap(c=>i._change(c,+t-1))}})}renderTable(e,t,s){e.innerHTML="";const l=new Array(this.days).fill(0).map((n,r)=>r).reverse(),d=new Array(this.courses).fill(0).map((n,r)=>r),a=document.createElement("tr");for(const n of l){const r=document.createElement("th");r.innerHTML=`\u661F\u671F${n+1}`,r.style.border="1px solid #333",r.style.borderCollapse="collapse",a.appendChild(r)}const i=document.createElement("td");i.innerHTML="",i.style.border="1px solid #333",i.style.borderCollapse="collapse",a.appendChild(i),e.appendChild(a);for(const n of d){const r=document.createElement("tr");for(const c of l){const h=document.createElement("td"),p=+this.courses*c+n,y=this.findByTeacher(t,p);h.id=`o${p}`,h.style.border="1px solid #333",h.style.borderCollapse="collapse",y.length>0?(h.innerHTML=`${y[0].course.name}`,h.onclick=()=>{s(p,h)}):h.innerHTML="",r.appendChild(h)}const u=document.createElement("td");u.innerHTML=`\u7B2C${n+1}\u7BC0`,u.style.border="1px solid #333",u.style.borderCollapse="collapse",r.appendChild(u),e.appendChild(r)}}renderTable2(e,t){e.innerHTML="";const s=new Array(this.days).fill(0).map((i,n)=>n).reverse(),l=new Array(this.courses).fill(0).map((i,n)=>n),d=document.createElement("tr");for(const i of s){const n=document.createElement("th");n.style.border="1px solid #333",n.style.borderCollapse="collapse",n.innerHTML=`\u661F\u671F${i+1}`,d.appendChild(n)}const a=document.createElement("td");a.style.border="1px solid #333",a.style.borderCollapse="collapse",a.innerHTML="",d.appendChild(a),e.appendChild(d);for(const i of l){const n=document.createElement("tr");for(const u of s){const c=document.createElement("td"),h=document.createElement("div"),p=document.createElement("p"),y=this.index(u,i),g=this.findByTeacher(t,y);c.style.border="1px solid #333",c.style.borderCollapse="collapse",h.id=`t${y}`,g.length>0?p.innerHTML=`${g[0].course.name}`:p.innerHTML="",n.appendChild(c),c.appendChild(h),h.appendChild(p)}const r=document.createElement("td");r.innerHTML=`\u7B2C${i+1}\u7BC0`,r.style.border="1px solid #333",r.style.borderCollapse="collapse",n.appendChild(r),e.appendChild(n)}for(const i of this.changes){const n=document.getElementById(`t${i.from.index}`);n&&(n.innerHTML="");const r=document.getElementById(`t${i.to.index}`);r&&(r.innerHTML="")}for(const[i,n]of this.changes.entries()){const r=document.getElementById(`t${n.from.index}`);if(r){const c=document.createElement("p");r.appendChild(c),c.style.background="#d44",c.style.color="#fff",c.innerHTML=`Step. ${i}<br>- \u73ED\u7D1A${n.from.course.name} \u8001\u5E2B${n.to.teacher.name}`}const u=document.getElementById(`t${n.to.index}`);if(u){const c=document.createElement("p");u.appendChild(c),c.style.background="#5d5",c.style.color="#fff",c.innerHTML=`Step. ${i}<br>+ \u73ED\u7D1A${n.from.course.name} \u8001\u5E2B${n.to.teacher.name}`}}}}class v{constructor(){f(this,"sols",[])}}const A=new x,_=new v;function D(){const o=document.getElementById("originTable");o&&(o.innerHTML="");const e=document.getElementById("toTable");e&&(e.innerHTML="")}function I(){const o=document.getElementById("ss");o.innerHTML=""}const F=M($(()=>B(()=>import("./q-debc875d.js"),["build/q-debc875d.js","build/q-30db69eb.js"]),"s_xYL1qOwPyDI")),S={title:"\u8ABF\u8AB2\u7528"},P=Object.freeze(Object.defineProperty({__proto__:null,Global:v,env:A,global:_,clean:D,cleanSol:I,default:F,head:S},Symbol.toStringTag,{value:"Module"}));export{L as T,I as a,D as c,A as e,_ as g,P as i};
