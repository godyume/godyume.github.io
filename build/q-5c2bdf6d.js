var M=Object.defineProperty;var B=(o,e,t)=>e in o?M(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var x=(o,e,t)=>(B(o,typeof e!="symbol"?e+"":e,t),t);import{c as L,q as _,_ as A}from"./q-e61e0e02.js";class b{constructor(e){this.name=e}toString(){return this.name}}class w extends b{}class H extends b{}class g{constructor(e,t,s){this.teacher=e,this.course=t,this.index=s}toString(){return`${this.teacher.name} ${this.course.name}${this.index}`}}class D{constructor(e,t){this.from=e,this.to=t}toString(){return`\u73ED\u7D1A'${this.from.course.name}': [${this.from.teacher.name} ${+this.from.index+1}] <-> [${this.to.teacher.name} ${+this.to.index+1}]`}removes(){return[this.from,this.to]}addFrom(){return new g(this.from.teacher,this.from.course,this.to.index)}addTo(){return new g(this.to.teacher,this.to.course,this.from.index)}}let m;(function(o){o[o.invalid=0]="invalid",o[o.tempValid=1]="tempValid",o[o.valid=2]="valid"})(m||(m={}));class v{constructor(){x(this,"changes",[]);x(this,"set2",[]);x(this,"days",5);x(this,"courses",7)}index(e,t){return+this.courses*e+t}indexOf(e){return this.set2.findIndex(t=>t.teacher.name===e.teacher.name&&t.course.name===e.course.name&&t.index==e.index)}delete(e){const t=this.indexOf(e);t>-1&&this.set2.splice(t,1)}setDays(e){this.days=Math.min(Math.max(+e,1),7)}setCourses(e){this.courses=Math.max(+e,1)}parse(e){return e.split(`
`).flatMap((s,l)=>l>this.days?[]:s.split(",").flatMap((d,p)=>{if(d==="")return[];if(p>this.courses)return[];const h=new H(d),i=+l*+this.courses+p;return[[h,i]]}))}setup(e,t){const s=new w(e);for(const[l,a]of this.parse(t)){const d=new g(s,l,a);this.set2.push(d)}}all(){return this.set2}findByTeacher(e,t){return t!=null?this.all().filter(s=>s.teacher.name===e.name&&s.index==t):this.all().filter(s=>s.teacher.name==e.name)}findByCourse(e,t){return t!=null?this.all().filter(s=>s.course.name===e.name&&s.index===t):this.all().filter(s=>s.course.name===e.name)}findByIndex(e){const t=+e%+this.courses+1,s=+e/+this.courses+1;return[t,s]}copy(){const e=new v;return e.set2=Array.from(this.set2),e.changes=Array.from(this.changes),e.days=this.days,e.courses=this.courses,e}append(e){const t=this.copy();if(t.changes.push(e),e.from.course.name==="x"||e.from.course.name==="X")return[t,m.invalid];if(this.changes.length!=0&&this.changes[0].from.index==e.to.index)return[t,m.invalid];for(const s of e.removes())if(t.indexOf(s)!=-1)t.delete(s);else return[t,m.invalid];if(this.findByTeacher(e.addTo().teacher,e.addTo().index).length==0)t.set2.push(e.addTo());else return[t,m.invalid];switch(this.findByTeacher(e.addFrom().teacher,e.addFrom().index).length){case 0:return t.set2.push(e.addFrom()),[t,m.valid];case 1:return t.set2.push(e.addFrom()),[t,m.tempValid];default:return[t,m.invalid]}}change(e,t,s){const l=this.findByTeacher(e,t);if(l.length<=0)return[];const a=l[0].course,d=new g(e,a,t);return this._change(d,s)}_change(e,t){return t<=0?[]:this.findByCourse(e.course).filter(a=>a.teacher.name!==e.teacher.name).flatMap(a=>{const d=new D(e,a),[p,h]=this.append(d);switch(h){case m.invalid:return[];case m.valid:return[p];case m.tempValid:const i=e.teacher,n=d.to.index;return this.findByTeacher(i,n).filter(r=>r.course.name!==e.course.name).flatMap(r=>p._change(r,+t-1))}})}renderTable(e,t,s,l){e.innerHTML="";const a=new Array(this.days).fill(0).map((n,r)=>r),d=s?a:a.reverse(),p=new Array(this.courses).fill(0).map((n,r)=>r),h=document.createElement("tr");for(const n of d){const r=document.createElement("th");r.innerHTML=`\u661F\u671F${n+1}`,r.style.border="1px solid #333",r.style.borderCollapse="collapse",h.appendChild(r)}const i=document.createElement("td");i.innerHTML="",i.style.border="1px solid #333",i.style.borderCollapse="collapse",h.appendChild(i),e.appendChild(h);for(const n of p){const r=document.createElement("tr");for(const c of d){const u=document.createElement("td"),y=+this.courses*c+n,T=this.findByTeacher(t,y);u.id=`o${y}`,u.style.border="1px solid #333",u.style.borderCollapse="collapse",T.length>0?(u.innerHTML=`${T[0].course.name}`,u.onclick=()=>{l(y,u)}):u.innerHTML="",r.appendChild(u)}const f=document.createElement("td");f.innerHTML=`\u7B2C${n+1}\u7BC0`,f.style.border="1px solid #333",f.style.borderCollapse="collapse",r.appendChild(f),e.appendChild(r)}}renderTable2(e,t,s){e.innerHTML="";const l=new Array(this.days).fill(0).map((i,n)=>n),a=s?l:l.reverse(),d=new Array(this.courses).fill(0).map((i,n)=>n),p=document.createElement("tr");for(const i of a){const n=document.createElement("th");n.style.border="1px solid #333",n.style.borderCollapse="collapse",n.innerHTML=`\u661F\u671F${i+1}`,p.appendChild(n)}const h=document.createElement("td");h.style.border="1px solid #333",h.style.borderCollapse="collapse",h.innerHTML="",p.appendChild(h),e.appendChild(p);for(const i of d){const n=document.createElement("tr");for(const f of a){const c=document.createElement("td"),u=document.createElement("div"),y=document.createElement("p"),T=this.index(f,i),E=this.findByTeacher(t,T);c.style.border="1px solid #333",c.style.borderCollapse="collapse",u.id=`t${T}`,E.length>0?y.innerHTML=`${E[0].course.name}`:y.innerHTML="",n.appendChild(c),c.appendChild(u),u.appendChild(y)}const r=document.createElement("td");r.innerHTML=`\u7B2C${i+1}\u7BC0`,r.style.border="1px solid #333",r.style.borderCollapse="collapse",n.appendChild(r),e.appendChild(n)}for(const i of this.changes){const n=document.getElementById(`t${i.from.index}`);n&&(n.innerHTML="");const r=document.getElementById(`t${i.to.index}`);r&&(r.innerHTML="")}for(const[i,n]of this.changes.entries()){const r=document.getElementById(`t${n.from.index}`);if(r){const c=document.createElement("p");r.appendChild(c),c.style.background="#d44",c.style.color="#fff",c.innerHTML=`Step. ${i}<br>- \u73ED\u7D1A${n.from.course.name} \u8001\u5E2B${n.to.teacher.name}`}const f=document.getElementById(`t${n.to.index}`);if(f){const c=document.createElement("p");f.appendChild(c),c.style.background="#5d5",c.style.color="#fff",c.innerHTML=`Step. ${i}<br>+ \u73ED\u7D1A${n.from.course.name} \u8001\u5E2B${n.to.teacher.name}`}}}}class ${constructor(){x(this,"sols",[])}}const F=new v,I=new $;let C;(function(o){o.originTable="originTable",o.toTable="toTable",o.selectSol="selectSol",o.selectTeacher="selectTeacher"})(C||(C={}));function S(o){const e=document.getElementById(o);e&&(e.innerHTML="")}const O=L(_(()=>A(()=>import("./q-505929d3.js"),["build/q-505929d3.js","build/q-e61e0e02.js"]),"s_xYL1qOwPyDI")),V={title:"\u8ABF\u8AB2\u7528"},q=Object.freeze(Object.defineProperty({__proto__:null,Global:$,env:F,_global:I,get Elements(){return C},clean:S,default:O,head:V},Symbol.toStringTag,{value:"Module"}));export{C as E,w as T,I as _,S as c,F as e,q as i};
