var $=Object.defineProperty;var C=(c,e,t)=>e in c?$(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var g=(c,e,t)=>(C(c,typeof e!="symbol"?e+"":e,t),t);import{c as E,q as B,_ as M}from"./q-6839d46b.js";class v{constructor(e){this.name=e}toString(){return this.name}}class A extends v{}class L extends v{}class y{constructor(e,t,n){this.teacher=e,this.course=t,this.index=n}toString(){return`${this.teacher.name} ${this.course.name}${this.index}`}}class w{constructor(e,t){this.from=e,this.to=t}toString(){return`\u73ED\u7D1A'${this.from.course.name}': [${this.from.teacher.name} ${+this.from.index+1}] <-> [${this.to.teacher.name} ${+this.to.index+1}]`}removes(){return[this.from,this.to]}addFrom(){return new y(this.from.teacher,this.from.course,this.to.index)}addTo(){return new y(this.to.teacher,this.to.course,this.from.index)}}let h;(function(c){c[c.invalid=0]="invalid",c[c.tempValid=1]="tempValid",c[c.valid=2]="valid"})(h||(h={}));class T{constructor(){g(this,"changes",[]);g(this,"set2",[]);g(this,"days",5);g(this,"courses",7)}index(e,t){return+this.courses*e+t}indexOf(e){return this.set2.findIndex(t=>t.teacher.name===e.teacher.name&&t.course.name===e.course.name&&t.index==e.index)}delete(e){const t=this.indexOf(e);t>-1&&this.set2.splice(t,1)}setDays(e){this.days=Math.min(Math.max(+e,1),7)}setCourses(e){this.courses=Math.max(+e,1)}parse(e){return e.split(`
`).flatMap((n,l)=>n.split(",").flatMap((a,o)=>{if(a==="")return[];if(o>this.courses)return[];const s=new L(a),r=+l*+this.courses+o;return[[s,r]]}))}setup(e,t){const n=new A(e);for(const[l,d]of this.parse(t)){const a=new y(n,l,d);this.set2.push(a)}}all(){return this.set2}findByTeacher(e,t){return t!=null?this.all().filter(n=>n.teacher.name===e.name&&n.index==t):this.all().filter(n=>n.teacher.name==e.name)}findByCourse(e,t){return t!=null?this.all().filter(n=>n.course.name===e.name&&n.index===t):this.all().filter(n=>n.course.name===e.name)}findByIndex(e){const t=+e%+this.courses+1,n=+e/+this.courses+1;return[t,n]}copy(){const e=new T;return e.set2=Array.from(this.set2),e.changes=Array.from(this.changes),e.days=this.days,e.courses=this.courses,e}append(e){const t=this.copy();if(t.changes.push(e),this.changes.length!=0&&this.changes[0].from.index==e.to.index)return console.log("invalid loop"),[t,h.invalid];for(const n of e.removes())if(console.log("check set"),console.log(n),t.indexOf(n)!=-1)t.delete(n);else return console.log("invalid \u8AB2-1"),[t,h.invalid];if(this.findByTeacher(e.addTo().teacher,e.addTo().index).length==0)t.set2.push(e.addTo());else return console.log("invalid \u5C0D\u65B9\u6C92\u7A7A"),[t,h.invalid];switch(this.findByTeacher(e.addFrom().teacher,e.addFrom().index).length){case 0:return t.set2.push(e.addFrom()),[t,h.valid];case 1:return t.set2.push(e.addFrom()),[t,h.tempValid];default:return console.log("invalid \u8AB2 2"),[t,h.invalid]}}change(e,t,n){const l=this.findByTeacher(e,t);if(console.log(l),l.length<=0)return[];const d=l[0].course,a=new y(e,d,t);return console.log(a),this._change(a,n)}_change(e,t){if(t<=0)return[];const n=this.findByCourse(e.course).filter(d=>d.teacher.name!==e.teacher.name);return console.log(this.findByCourse(e.course)),console.log(n),n.flatMap(d=>{const a=new w(e,d),[o,s]=this.append(a);switch(s){case h.invalid:return console.log("invalid"),[];case h.valid:return console.log("valid"),[o];case h.tempValid:console.log("temp valid");const r=e.teacher,m=a.to.index;return this.findByTeacher(r,m).filter(i=>i.course.name!==e.course.name).flatMap(i=>o._change(i,+t-1))}})}renderTable(e,t,n){e.innerHTML="";const l=new Array(this.days).fill(0).map((s,r)=>r).reverse(),d=new Array(this.courses).fill(0).map((s,r)=>r),a=document.createElement("tr");for(const s of l){const r=document.createElement("th");r.innerHTML=`\u661F\u671F${s+1}`,a.appendChild(r)}const o=document.createElement("td");o.innerHTML="",a.appendChild(o),e.appendChild(a);for(const s of d){const r=document.createElement("tr");for(const i of l){const u=document.createElement("td"),f=+this.courses*i+s,p=this.findByTeacher(t,f);u.id=`o${f}`,p.length>0?(u.innerHTML=`${p[0].course.name}`,u.onclick=()=>{console.log(`click ${f} ${p}`),n(f,u)}):u.innerHTML="",r.appendChild(u)}const m=document.createElement("td");m.innerHTML=`\u7B2C${s+1}\u7BC0`,r.appendChild(m),e.appendChild(r)}}renderTable2(e,t){e.innerHTML="";const n=new Array(this.days).fill(0).map((o,s)=>s).reverse(),l=new Array(this.courses).fill(0).map((o,s)=>s),d=document.createElement("tr");for(const o of n){const s=document.createElement("th");s.innerHTML=`\u661F\u671F${o+1}`,d.appendChild(s)}const a=document.createElement("td");a.innerHTML="",d.appendChild(a),e.appendChild(d);for(const o of l){const s=document.createElement("tr");for(const m of n){const i=document.createElement("td"),u=document.createElement("div"),f=document.createElement("p"),p=this.index(m,o),x=this.findByTeacher(t,p);u.id=`t${p}`,x.length>0?f.innerHTML=`${x[0].course.name}`:f.innerHTML="",s.appendChild(i),i.appendChild(u),u.appendChild(f)}const r=document.createElement("td");r.innerHTML=`\u7B2C${o+1}\u7BC0`,s.appendChild(r),e.appendChild(s)}for(const o of this.changes){const s=document.getElementById(`t${o.from.index}`);s&&(s.innerHTML="");const r=document.getElementById(`t${o.to.index}`);r&&(r.innerHTML="")}for(const[o,s]of this.changes.entries()){const r=document.getElementById(`t${s.from.index}`);if(r){const i=document.createElement("p");r.appendChild(i),i.style.background="#e44",i.style.color="#fff",i.innerHTML=`Step. ${o}<br>- \u73ED\u7D1A${s.from.course.name} \u8001\u5E2B${s.to.teacher.name}`}const m=document.getElementById(`t${s.to.index}`);if(m){const i=document.createElement("p");m.appendChild(i),i.style.background="#4e4",i.style.color="#fff",i.innerHTML=`Step. ${o}<br>+ \u73ED\u7D1A${s.from.course.name} \u8001\u5E2B${s.to.teacher.name}`}}}}const H=new T,_=E(B(()=>M(()=>import("./q-4af564c1.js"),["build/q-4af564c1.js","build/q-6839d46b.js"]),"s_SLLX8NUAZ6U")),D={title:"Qwik Flower"},I=Object.freeze(Object.defineProperty({__proto__:null,env:H,default:_,head:D},Symbol.toStringTag,{value:"Module"}));export{A as T,H as e,I as i};
